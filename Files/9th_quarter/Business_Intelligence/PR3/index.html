<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Riesgo Crediticio - Modelo Predictivo</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root {
            --purple-primary: #6a1b9a;
            --purple-secondary: #9c27b0;
            --purple-light: #e1bee7;
            --purple-dark: #4a006a;
            --purple-accent: #ce93d8;
        }
        
        body {
            background-color: #f8f9fa;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        .navbar {
            background: linear-gradient(135deg, var(--purple-primary), var(--purple-dark));
            box-shadow: 0 4px 12px rgba(106, 27, 154, 0.3);
        }
        
        .nav-tabs {
            border-bottom: 3px solid var(--purple-secondary);
        }
        
        .nav-tabs .nav-link {
            color: var(--purple-dark);
            font-weight: 600;
            border: none;
            padding: 12px 24px;
            transition: all 0.3s ease;
        }
        
        .nav-tabs .nav-link:hover {
            color: var(--purple-secondary);
            background-color: rgba(156, 39, 176, 0.05);
        }
        
        .nav-tabs .nav-link.active {
            color: var(--purple-secondary);
            border-bottom: 3px solid var(--purple-secondary);
            background-color: rgba(156, 39, 176, 0.1);
        }
        
        .card {
            border-radius: 12px;
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.08);
            margin-bottom: 24px;
            transition: transform 0.3s ease;
            border: none;
        }
        
        .card:hover {
            transform: translateY(-5px);
        }
        
        .card-header {
            background: linear-gradient(135deg, var(--purple-light), var(--purple-accent));
            color: var(--purple-dark);
            font-weight: 700;
            border-radius: 12px 12px 0 0 !important;
            border: none;
            padding: 16px 20px;
        }
        
        .card-body {
            padding: 20px;
        }
        
        .section-title {
            color: var(--purple-dark);
            border-left: 4px solid var(--purple-secondary);
            padding-left: 12px;
            margin: 24px 0 16px;
            font-weight: 600;
        }
        
        .metric-card {
            text-align: center;
            padding: 20px;
            border-radius: 12px;
            background: white;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            transition: all 0.3s ease;
            border: 1px solid rgba(156, 39, 176, 0.2);
        }
        
        .metric-card:hover {
            transform: scale(1.03);
            box-shadow: 0 8px 16px rgba(156, 39, 176, 0.2);
        }
        
        .metric-value {
            font-size: 2.2rem;
            font-weight: 700;
            color: var(--purple-secondary);
            margin: 10px 0;
        }
        
        .metric-label {
            color: #666;
            font-size: 1rem;
        }
        
        .authors {
            background: linear-gradient(135deg, var(--purple-light), #f3e5f5);
            border-radius: 12px;
            padding: 20px;
            margin-top: 30px;
        }
        
        .author-list {
            list-style-type: none;
            padding: 0;
            margin: 0;
        }
        
        .author-list li {
            padding: 8px 0;
            border-bottom: 1px solid rgba(156, 39, 176, 0.1);
            color: var(--purple-dark);
            text-align: center;
        }
        
        .author-list li:last-child {
            border-bottom: none;
        }
        
        .image-container {
            text-align: center;
            margin: 20px 0;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.15);
        }
        
        .model-image {
            max-width: 100%;
            height: auto;
            border: 2px solid var(--purple-accent);
            border-radius: 8px;
        }
        
        .highlight-box {
            background-color: rgba(156, 39, 176, 0.08);
            border-left: 4px solid var(--purple-secondary);
            padding: 15px;
            margin: 15px 0;
            border-radius: 0 8px 8px 0;
        }
        
        .feature-item {
            background: rgba(156, 39, 176, 0.05);
            padding: 12px;
            border-radius: 8px;
            margin-bottom: 10px;
            transition: all 0.3s ease;
        }
        
        .feature-item:hover {
            background: rgba(156, 39, 176, 0.1);
            transform: translateX(5px);
        }
        
        .form-control:focus, .form-select:focus {
            border-color: var(--purple-secondary);
            box-shadow: 0 0 0 0.25rem rgba(156, 39, 176, 0.25);
        }
        
        .btn-purple {
            background: linear-gradient(135deg, var(--purple-primary), var(--purple-secondary));
            border: none;
            color: white;
            font-weight: 600;
            padding: 10px 24px;
            border-radius: 8px;
            transition: all 0.3s ease;
        }
        
        .btn-purple:hover {
            background: linear-gradient(135deg, var(--purple-dark), var(--purple-primary));
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(106, 27, 154, 0.4);
        }
        
        .table-purple {
            --bs-table-bg: var(--purple-light);
            --bs-table-striped-bg: var(--purple-accent);
            --bs-table-striped-color: var(--purple-dark);
            --bs-table-active-bg: rgba(156, 39, 176, 0.3);
            --bs-table-active-color: var(--purple-dark);
            --bs-table-hover-bg: rgba(156, 39, 176, 0.15);
            --bs-table-hover-color: var(--purple-dark);
            width: 100%;
            border-radius: 8px;
            overflow: hidden;
        }
        
        .progress-purple {
            height: 10px;
            background-color: #e1bee7;
        }
        
        .progress-bar {
            background: linear-gradient(135deg, var(--purple-primary), var(--purple-secondary));
        }
        
        .shap-container {
            display: flex;
            flex-wrap: wrap;
            justify-content: space-between;
            gap: 20px;
        }
        
        .shap-box {
            flex: 1;
            min-width: 300px;
            background: white;
            border-radius: 12px;
            padding: 15px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.08);
            border: 1px solid var(--purple-light);
        }
        
        footer {
            background: linear-gradient(135deg, var(--purple-dark), var(--purple-primary));
            color: white;
            padding: 20px 0;
            margin-top: 40px;
        }
        
        @media (max-width: 768px) {
            .nav-tabs .nav-link {
                padding: 10px 15px;
                font-size: 0.9rem;
            }
            
            .shap-container {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-dark">
        <div class="container">
            <a class="navbar-brand fw-bold" href="#">
                <i class="fas fa-chart-line me-2"></i>Riesgo Crediticio ML
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
        </div>
    </nav>

    <div class="container my-4">
        <div class="text-center mb-5">
            <h1 class="display-4 fw-bold" style="color: var(--purple-dark);">
                <i class="fas fa-credit-card me-3"></i>Análisis de Riesgo Crediticio
            </h1>
            <p class="lead text-muted">Modelo predictivo para evaluación de riesgo crediticio con enfoque en explicabilidad y equidad</p>
        </div>

        <div class="authors">
            <h3 class="text-center mb-4" style="color: var(--purple-dark);"><i class="fas fa-user-friends me-2"></i>Autores</h3>
            <ul class="author-list">
                <li>Diego Monroy | Ariel Buenfil | Alan Valbuena | Damaris Dzul | Sergio Barrera | Moises Carrillo</li>
            </ul>
        </div>

        <ul class="nav nav-tabs" id="myTab" role="tablist">
            <li class="nav-item" role="presentation">
                <button class="nav-link active" id="eda-tab" data-bs-toggle="tab" data-bs-target="#eda" type="button" role="tab" aria-controls="eda" aria-selected="true">
                    <i class="fas fa-chart-bar me-2"></i>EDA
                </button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="preprocessing-tab" data-bs-toggle="tab" data-bs-target="#preprocessing" type="button" role="tab" aria-controls="preprocessing" aria-selected="false">
                    <i class="fas fa-gem me-2"></i>Preprocessing
                </button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="modeling-tab" data-bs-toggle="tab" data-bs-target="#modeling" type="button" role="tab" aria-controls="modeling" aria-selected="false">
                    <i class="fas fa-brain me-2"></i>Modeling
                </button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="testing-tab" data-bs-toggle="tab" data-bs-target="#testing" type="button" role="tab" aria-controls="testing" aria-selected="false">
                    <i class="fas fa-vial me-2"></i>Testing
                </button>
            </li>
        </ul>

        <div class="tab-content mt-4" id="myTabContent">
            <!-- EDA Tab -->
            <div class="tab-pane fade show active" id="eda" role="tabpanel" aria-labelledby="eda-tab">
                <div class="row">
                    <div class="col-md-6">
                        <div class="card">
                            <div class="card-header">
                                <i class="fas fa-database me-2"></i>Información General del Dataset
                            </div>
                            <div class="card-body">
                                <ul class="list-group list-group-flush">
                                    <li class="list-group-item"><strong>Dimensiones:</strong> 1000 filas × 21 columnas</li>
                                    <li class="list-group-item"><strong>Variables numéricas:</strong> 7</li>
                                    <li class="list-group-item"><strong>Variables categóricas:</strong> 14</li>
                                    <li class="list-group-item"><strong>Valores faltantes:</strong> 0 (0.00%)</li>
                                    <li class="list-group-item"><strong>Registros duplicados:</strong> 0 (0.00%)</li>
                                    <li class="list-group-item"><strong>Calidad de datos:</strong> 100.00%</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    
                    <div class="col-md-6">
                        <div class="card">
                            <div class="card-header">
                                <i class="fas fa-balance-scale me-2"></i>Variable Objetivo - Target
                            </div>
                            <div class="card-body">
                                <ul class="list-group list-group-flush">
                                    <li class="list-group-item"><strong>Clase '1' (Buenos pagadores):</strong> 700 registros (70.00%)</li>
                                    <li class="list-group-item"><strong>Clase '2' (Malos pagadores):</strong> 300 registros (30.00%)</li>
                                    <li class="list-group-item"><strong>Ratio de desbalance:</strong> 2.33:1</li>
                                </ul>
                                <div class="mt-3">
                                    <div class="d-flex justify-content-between mb-1">
                                        <span>Buenos pagadores (70%)</span>
                                        <span>70%</span>
                                    </div>
                                    <div class="progress progress-purple mb-3">
                                        <div class="progress-bar" role="progressbar" style="width: 70%"></div>
                                    </div>
                                    <div class="d-flex justify-content-between mb-1">
                                        <span>Malos pagadores (30%)</span>
                                        <span>30%</span>
                                    </div>
                                    <div class="progress progress-purple">
                                        <div class="progress-bar bg-warning" role="progressbar" style="width: 30%"></div>
                                    </div>
                                </div>
                                <div class="alert alert-warning mt-3">
                                    <i class="fas fa-exclamation-triangle me-2"></i>El dataset presenta un significativo desbalance de clases, lo que requiere técnicas específicas de manejo durante el modelado.
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="col-md-12">
                        <div class="card">
                            <div class="card-header">
                                <i class="fas fa-chart-line me-2"></i>Hallazgos Clave del EDA
                            </div>
                            <div class="card-body">
                                <div class="row">
                                    <div class="col-md-6">
                                        <h5 class="section-title">Variables Numéricas</h5>
                                        <ul class="list-group list-group-flush">
                                            <li class="list-group-item">
                                                <strong>Duración del crédito:</strong> Los malos pagadores tienen una duración promedio de 24.86 meses vs 19.21 meses de los buenos pagadores (+29.43%).
                                            </li>
                                            <li class="list-group-item">
                                                <strong>Monto del crédito:</strong> Los malos pagadores solicitan montos promedio de 3,938.13 vs 2,985.46 de los buenos pagadores (+31.91%).
                                            </li>
                                            <li class="list-group-item">
                                                <strong>Outliers:</strong> Se detectaron 326 outliers en variables numéricas, principalmente en <code>num_dependents</code> (15.50%).
                                            </li>
                                        </ul>
                                    </div>
                                    <div class="col-md-6">
                                        <h5 class="section-title">Variables Categóricas</h5>
                                        <ul class="list-group list-group-flush">
                                            <li class="list-group-item">
                                                <strong>Historial crediticio:</strong> Para la categoría A30 (crítico), el 62.5% son malos pagadores.
                                            </li>
                                            <li class="list-group-item">
                                                <strong>Cuenta corriente:</strong> Para la categoría A11 (baja), el 49.27% son malos pagadores.
                                            </li>
                                            <li class="list-group-item">
                                                <strong>Propiedad:</strong> Quienes poseen propiedad de alto valor (A121) tienen solo 21.28% de malos pagadores.
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                                
                                <div class="highlight-box mt-4">
                                    <h5 class="mb-3"><i class="fas fa-lightbulb me-2"></i>Insights de Negocio</h5>
                                    <p>Los perfiles de mayor riesgo se caracterizan por: montos de crédito altos (>3,972), duración prolongada (>24 meses), historial crediticio crítico (A30), y cuenta corriente con bajo balance (A11). Estos factores son indicadores tempranos de potencial impago y deben priorizarse en la evaluación de solicitudes.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Preprocessing Tab -->
            <div class="tab-pane fade" id="preprocessing" role="tabpanel" aria-labelledby="preprocessing-tab">
                <div class="row">
                    <div class="col-md-12">
                        <div class="card">
                            <div class="card-header">
                                <i class="fas fa-sync-alt me-2"></i>Estrategias de Preprocesamiento
                            </div>
                            <div class="card-body">
                                <p>Se implementaron cuatro estrategias distintas de preprocesamiento para optimizar para diferentes tipos de algoritmos de machine learning:</p>
                                
                                <div class="row mt-4">
                                    <div class="col-md-6 mb-4">
                                        <div class="card h-100">
                                            <div class="card-header bg-gradient" style="background: linear-gradient(135deg, #e1bee7, #ce93d8);">
                                                <i class="fas fa-calculator me-2"></i>Preprocesamiento para Regresión Logística
                                            </div>
                                            <div class="card-body">
                                                <ul>
                                                    <li><strong>Tratamiento de outliers:</strong> Winsorización en variables clave (duración, monto, edad)</li>
                                                    <li><strong>Transformaciones:</strong> Variables logarítmicas y ratios (pago mensual)</li>
                                                    <li><strong>One-Hot Encoding:</strong> para variables categóricas con <code>drop_first=True</code></li>
                                                    <li><strong>Estandarización:</strong> Escalado de variables numéricas con StandardScaler</li>
                                                    <li><strong>Características agrupadas:</strong> Nuevas categorías para duración, monto y edad</li>
                                                </ul>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="col-md-6 mb-4">
                                        <div class="card h-100">
                                            <div class="card-header bg-gradient" style="background: linear-gradient(135deg, #e1bee7, #ce93d8);">
                                                <i class="fas fa-tree me-2"></i>Preprocesamiento para Árboles
                                            </div>
                                            <div class="card-body">
                                                <ul>
                                                    <li><strong>Suavizado de outliers:</strong> Winsorización menos agresiva (3×IQR)</li>
                                                    <li><strong>Características de interacción:</strong> ratios y variables derivadas</li>
                                                    <li><strong>Codificación ordinal:</strong> para variables ordinales (ahorros, empleo, etc.)</li>
                                                    <li><strong>Target Encoding:</strong> regularizado para la variable propósito</li>
                                                    <li><strong>Eliminación:</strong> de variables de baja relevancia (residencia, dependientes)</li>
                                                    <li><strong>Transformaciones:</strong> logaritmo y variables polinómicas</li>
                                                </ul>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="col-md-6 mb-4">
                                        <div class="card h-100">
                                            <div class="card-header bg-gradient" style="background: linear-gradient(135deg, #e1bee7, #ce93d8);">
                                                <i class="fas fa-project-diagram me-2"></i>Preprocesamiento para Ensemble
                                            </div>
                                            <div class="card-body">
                                                <ul>
                                                    <li><strong>Interacciones estratégicas:</strong> combinaciones basadas en hallazgos del EDA</li>
                                                    <li><strong>Variables de riesgo acumulativo:</strong> conteo y ratio de factores de riesgo</li>
                                                    <li><strong>Target Encoding regularizado:</strong> para variables categóricas clave</li>
                                                    <li><strong>Selección de características:</strong> basada en varianza y correlación</li>
                                                    <li><strong>Características adicionales:</strong> específicas para modelos ensemble</li>
                                                </ul>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="col-md-6 mb-4">
                                        <div class="card h-100">
                                            <div class="card-header bg-gradient" style="background: linear-gradient(135deg, #e1bee7, #ce93d8);">
                                                <i class="fas fa-microchip me-2"></i>Preprocesamiento para Red Neuronal
                                            </div>
                                            <div class="card-body">
                                                <ul>
                                                    <li><strong>Normalización:</strong> todas las características escaladas al rango [0,1]</li>
                                                    <li><strong>Características polinómicas:</strong> para capturar relaciones no lineales</li>
                                                    <li><strong>Preparación para embeddings:</strong> variables categóricas convertidas a índices</li>
                                                    <li><strong>Perfiles de riesgo sintéticos:</strong> creación de variables de alto/bajo riesgo</li>
                                                    <li><strong>Agrupamiento:</strong> para edad y monto (ayuda a la red a aprender patrones)</li>
                                                </ul>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="col-md-12 mt-4">
                        <div class="card">
                            <div class="card-header">
                                <i class="fas fa-robot me-2"></i>Benchmarking con LazyPredict
                            </div>
                            <div class="card-body">
                                <p>Se realizó un benchmark exhaustivo utilizando LazyPredict para identificar la mejor combinación de preprocesamiento y algoritmo. Se evaluaron 27 modelos para cada estrategia de preprocesamiento, priorizando la capacidad de detectar malos pagadores (clase 0).</p>
                                
                                <div class="table-responsive mt-4">
                                    <table class="table table-purple table-striped">
                                        <thead>
                                            <tr>
                                                <th>Preprocesamiento</th>
                                                <th>Mejor Modelo</th>
                                                <th>Sensitivity</th>
                                                <th>AUC-PR</th>
                                                <th>AUC-ROC</th>
                                                <th>F1-Score</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr>
                                                <td><strong>Árboles</strong></td>
                                                <td>BernoulliNB</td>
                                                <td>0.617</td>
                                                <td>0.517</td>
                                                <td>0.237</td>
                                                <td>0.569</td>
                                            </tr>
                                            <tr>
                                                <td>Regresión Logística</td>
                                                <td>BernoulliNB</td>
                                                <td>0.467</td>
                                                <td>0.392</td>
                                                <td>0.334</td>
                                                <td>0.463</td>
                                            </tr>
                                            <tr>
                                                <td>Red Neuronal</td>
                                                <td>BernoulliNB</td>
                                                <td>0.567</td>
                                                <td>0.400</td>
                                                <td>0.316</td>
                                                <td>0.507</td>
                                            </tr>
                                            <tr>
                                                <td>Ensamble</td>
                                                <td>BernoulliNB</td>
                                                <td>0.500</td>
                                                <td>0.391</td>
                                                <td>0.323</td>
                                                <td>0.480</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                                
                                <div class="highlight-box mt-4">
                                    <h5 class="mb-3"><i class="fas fa-star me-2"></i>Recomendación Inicial vs. Modelo Final</h5>
                                    <p><strong>Recomendación inicial (LazyPredict):</strong> BernoulliNB con preprocesamiento para árboles, con una capacidad del 61.7% para detectar malos pagadores.</p>
                                    <p><strong>Modelo final implementado:</strong> XGBoost con calibración isotónica</p>
                                    <p><strong>¿Por qué el cambio?</strong> Aunque BernoulliNB mostró buen rendimiento inicial, se seleccionó XGBoost con calibración isotónica por:</p>
                                    <ul>
                                        <li><strong>Mejor rendimiento:</strong> XGBoost logró un recall de 0.8143 vs 0.617 de BernoulliNB</li>
                                        <li><strong>Mejor calibración:</strong> Las probabilidades de XGBoost son más confiables después de la calibración</li>
                                        <li><strong>Mayor flexibilidad:</strong> Capacidad para capturar relaciones complejas y no lineales</li>
                                        <li><strong>Explicabilidad:</strong> Compatibilidad con SHAP para explicaciones globales y locales</li>
                                        <li><strong>Robustez:</strong> Menor varianza y mayor estabilidad en predicciones</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Modeling Tab -->
            <div class="tab-pane fade" id="modeling" role="tabpanel" aria-labelledby="modeling-tab">
                <div class="row">
                    <div class="col-md-12">
                        <div class="card">
                            <div class="card-header">
                                <i class="fas fa-brain me-2"></i>Modelo Final: XGBoost con Calibración Isotónica
                            </div>
                            <div class="card-body">
                                <p>Se implementó un modelo XGBoost optimizado con búsqueda aleatoria de hiperparámetros y calibración isotónica para garantizar probabilidades bien calibradas.</p>
                                
                                <div class="row mt-4">
                                    <div class="col-md-6 mb-4">
                                        <div class="card">
                                            <div class="card-header">
                                                <i class="fas fa-sliders-h me-2"></i>Hiperparámetros Optimizados
                                            </div>
                                            <div class="card-body">
                                                <ul class="list-group list-group-flush">
                                                    <li class="list-group-item"><strong>n_estimators:</strong> 50</li>
                                                    <li class="list-group-item"><strong>max_depth:</strong> 5</li>
                                                    <li class="list-group-item"><strong>learning_rate:</strong> 0.05</li>
                                                    <li class="list-group-item"><strong>subsample:</strong> 1.0</li>
                                                    <li class="list-group-item"><strong>colsample_bytree:</strong> 0.6</li>
                                                    <li class="list-group-item"><strong>gamma:</strong> 0.5</li>
                                                    <li class="list-group-item"><strong>min_child_weight:</strong> 3</li>
                                                    <li class="list-group-item"><strong>scale_pos_weight:</strong> 2.333 (para balancear clases)</li>
                                                </ul>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="col-md-6 mb-4">
                                        <div class="card">
                                            <div class="card-header">
                                                <i class="fas fa-balance-scale me-2"></i>Umbral de Decisión
                                            </div>
                                            <div class="card-body">
                                                <p>Se optimizó el umbral de decisión para maximizar el F1-Score:</p>
                                                <ul class="list-group list-group-flush">
                                                    <li class="list-group-item"><strong>Umbral estándar:</strong> 0.5</li>
                                                    <li class="list-group-item"><strong>Umbral óptimo:</strong> 0.1667</li>
                                                    <li class="list-group-item"><strong>Efecto:</strong> Aumento del recall de 0.8143 a 0.9214</li>
                                                    <li class="list-group-item"><strong>Trade-off:</strong> Reducción de la precisión de 0.8085 a 0.7633</li>
                                                    <li class="list-group-item"><strong>Justificación:</strong> Priorizar la detección de malos pagadores para minimizar pérdidas</li>
                                                </ul>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <h5 class="section-title mt-4">Métricas de Rendimiento</h5>
                                <div class="row">
                                    <div class="col-md-3">
                                        <div class="metric-card">
                                            <div class="metric-value">0.81</div>
                                            <div class="metric-label">Recall (TPR)</div>
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="metric-card">
                                            <div class="metric-value">0.81</div>
                                            <div class="metric-label">Precisión</div>
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="metric-card">
                                            <div class="metric-value">0.81</div>
                                            <div class="metric-label">F1-Score</div>
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="metric-card">
                                            <div class="metric-value">0.86</div>
                                            <div class="metric-label">PR-AUC</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="col-md-12 mt-4">
                        <div class="card">
                            <div class="card-header">
                                <i class="fas fa-chart-area me-2"></i>Visualizaciones de Evaluación
                            </div>
                            <div class="card-body">
                                <div class="row">
                                    <div class="col-md-6 mb-4">
                                        <div class="image-container">
                                            <img src="/Files/9th_quarter/Business_Intelligence/PR3/Docs/Images/confusion_matrix.png" alt="Matriz de Confusión" class="model-image">
                                            <p class="mt-2 text-muted">Matriz de Confusión - 81.43% de malos pagadores correctamente identificados</p>
                                        </div>
                                    </div>
                                    <div class="col-md-6 mb-4">
                                        <div class="image-container">
                                            <img src="/Files/9th_quarter/Business_Intelligence/PR3/Docs/Images/roc_pr_curves.png" alt="Curvas ROC y PR" class="model-image">
                                            <p class="mt-2 text-muted">Curvas ROC (AUC: 0.7586) y PR (AUC: 0.8596)</p>
                                        </div>
                                    </div>
                                    <div class="col-md-6 mb-4">
                                        <div class="image-container">
                                            <img src="/Files/9th_quarter/Business_Intelligence/PR3/Docs/Images/probability_distribution.png" alt="Distribución de Probabilidades" class="model-image">
                                            <p class="mt-2 text-muted">Distribución de probabilidades por clase con umbral óptimo (0.1667)</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="col-md-12 mt-4">
                        <div class="card">
                            <div class="card-header">
                                <i class="fas fa-bullseye me-2"></i>Explicabilidad con SHAP
                            </div>
                            <div class="card-body">
                                <p>Se implementó SHAP (SHapley Additive exPlanations) para proporcionar explicaciones globales y locales del modelo.</p>
                                
                                <div class="row mb-4">
                                    <div class="col-md-12">
                                        <div class="image-container">
                                            <img src="/Files/9th_quarter/Business_Intelligence/PR3/Docs/Images/shap_summary.png" alt="Resumen SHAP" class="model-image">
                                            <p class="mt-2 text-muted">Importancia global de características - Las variables más influyentes son credit_amount, month_credit_duration y credit_history</p>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="shap-container">
                                    <div class="shap-box">
                                        <h5><i class="fas fa-user-times me-2"></i>Caso de Alto Riesgo</h5>
                                        <div class="image-container mb-3">
                                            <img src="/Files/9th_quarter/Business_Intelligence/PR3/Docs/Images/shap_alto_riesgo.png" alt="SHAP Alto Riesgo" class="model-image" style="max-height: 300px; object-fit: contain;">
                                        </div>
                                        <p>Este solicitante presenta un alto riesgo de impago debido principalmente al monto elevado del crédito, historial crediticio crítico y bajo balance en cuenta corriente.</p>
                                    </div>
                                    <div class="shap-box">
                                        <h5><i class="fas fa-user-clock me-2"></i>Caso Frontera</h5>
                                        <div class="image-container mb-3">
                                            <img src="/Files/9th_quarter/Business_Intelligence/PR3/Docs/Images/shap_caso_frontera.png" alt="SHAP Caso Frontera" class="model-image" style="max-height: 300px; object-fit: contain;">
                                        </div>
                                        <p>Este solicitante está cerca del umbral de decisión (probabilidad = 0.5040). Factores positivos como empleo estable y alto ahorro compensan factores de riesgo como el monto del crédito.</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Testing Tab -->
            <div class="tab-pane fade" id="testing" role="tabpanel" aria-labelledby="testing-tab">
                <div class="row">
                    <div class="col-md-12">
                        <div class="card">
                            <div class="card-header">
                                <i class="fas fa-vial me-2"></i>Prueba del Modelo
                            </div>
                            <div class="card-body">
                                <p>Ingrese los datos del solicitante para evaluar su riesgo crediticio utilizando el modelo XGBoost calibrado.</p>
                                
                                <form id="creditForm" class="mt-4">
                                    <div class="row g-3">
                                        <div class="col-md-6">
                                            <div class="mb-3">
                                                <label class="form-label"><i class="fas fa-calendar-alt me-2"></i>Duración del crédito (meses)</label>
                                                <input type="number" class="form-control" value="24" min="4" max="72">
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <div class="mb-3">
                                                <label class="form-label"><i class="fas fa-money-bill-wave me-2"></i>Monto del crédito</label>
                                                <input type="number" class="form-control" value="3000" min="250" max="18424">
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <div class="mb-3">
                                                <label class="form-label"><i class="fas fa-history me-2"></i>Historial crediticio</label>
                                                <select class="form-select">
                                                    <option value="A30">Crítico (A30)</option>
                                                    <option value="A31" selected>Bueno (A31)</option>
                                                    <option value="A32">Bueno (A32)</option>
                                                    <option value="A33">Advertencia (A33)</option>
                                                    <option value="A34">Crítico (A34)</option>
                                                </select>
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <div class="mb-3">
                                                <label class="form-label"><i class="fas fa-university me-2"></i>Balance cuenta corriente</label>
                                                <select class="form-select">
                                                    <option value="A11">Bajo (A11)</option>
                                                    <option value="A12" selected>Medio (A12)</option>
                                                    <option value="A13">Alto (A13)</option>
                                                    <option value="A14">Sin cuenta (A14)</option>
                                                </select>
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <div class="mb-3">
                                                <label class="form-label"><i class="fas fa-piggy-bank me-2"></i>Tipo de ahorros</label>
                                                <select class="form-select">
                                                    <option value="A61" selected>Bajo (A61)</option>
                                                    <option value="A62">Medio (A62)</option>
                                                    <option value="A63">Alto (A63)</option>
                                                    <option value="A64">Alto (A64)</option>
                                                    <option value="A65">Sin ahorros (A65)</option>
                                                </select>
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <div class="mb-3">
                                                <label class="form-label"><i class="fas fa-briefcase me-2"></i>Años de empleo</label>
                                                <select class="form-select">
                                                    <option value="A71">Junior (A71)</option>
                                                    <option value="A72">Junior (A72)</option>
                                                    <option value="A73" selected>Medio (A73)</option>
                                                    <option value="A74">Medio (A74)</option>
                                                    <option value="A75">Senior (A75)</option>
                                                </select>
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <div class="mb-3">
                                                <label class="form-label"><i class="fas fa-percentage me-2"></i>% de ingresos para pagos</label>
                                                <select class="form-select">
                                                    <option value="1">Bajo (1)</option>
                                                    <option value="2">Medio-bajo (2)</option>
                                                    <option value="3" selected>Medio-alto (3)</option>
                                                    <option value="4">Alto (4)</option>
                                                </select>
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <div class="mb-3">
                                                <label class="form-label"><i class="fas fa-user me-2"></i>Edad</label>
                                                <input type="number" class="form-control" value="35" min="19" max="75">
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="d-grid mt-4">
                                        <button type="button" class="btn btn-purple" onclick="predictRisk()">
                                            <i class="fas fa-calculator me-2"></i>Calcular Riesgo Crediticio
                                        </button>
                                    </div>
                                </form>
                                
                                <div id="predictionResult" class="mt-5 p-4 rounded d-none" style="background-color: #f8f5ff; border: 1px solid var(--purple-light);">
                                    <h4 class="mb-4" style="color: var(--purple-dark);"><i class="fas fa-chart-pie me-2"></i>Resultado de la Predicción</h4>
                                    <div class="row align-items-center">
                                        <div class="col-md-4 text-center mb-3 mb-md-0">
                                            <div id="riskGauge" style="width: 200px; height: 200px; margin: 0 auto;"></div>
                                        </div>
                                        <div class="col-md-8">
                                            <h2 id="riskLabel" class="fw-bold mb-3">RIESGO MODERADO</h2>
                                            <p id="riskDescription" class="mb-4">La probabilidad de impago es del <strong id="riskProbability">25.37%</strong>, lo que indica un riesgo moderado para aprobar el crédito.</p>
                                            <div class="d-flex align-items-center">
                                                <span class="me-3 fw-bold" style="color: var(--purple-dark);">Recomendación:</span>
                                                <span id="recommendation" class="badge bg-warning text-dark fs-5 p-2">REVISIÓN MANUAL</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="col-md-12 mt-4">
                        <div class="card">
                            <div class="card-header">
                                <i class="fas fa-lightbulb me-2"></i>Guía de Interpretación
                            </div>
                            <div class="card-body">
                                <div class="row">
                                    <div class="col-md-4 mb-4">
                                        <div class="feature-item">
                                            <h5 class="mb-2" style="color: var(--purple-dark);"><i class="fas fa-circle text-success me-2"></i>Bajo Riesgo</h5>
                                            <p>Probabilidad de impago &lt; 16.67%. Se recomienda aprobar el crédito con condiciones estándar.</p>
                                        </div>
                                    </div>
                                    <div class="col-md-4 mb-4">
                                        <div class="feature-item">
                                            <h5 class="mb-2" style="color: var(--purple-dark);"><i class="fas fa-circle text-warning me-2"></i>Riesgo Moderado</h5>
                                            <p>Probabilidad de impago entre 16.67% y 40%. Se recomienda revisión manual y posiblemente condiciones especiales.</p>
                                        </div>
                                    </div>
                                    <div class="col-md-4 mb-4">
                                        <div class="feature-item">
                                            <h5 class="mb-2" style="color: var(--purple-dark);"><i class="fas fa-circle text-danger me-2"></i>Alto Riesgo</h5>
                                            <p>Probabilidad de impago &gt; 40%. Se recomienda no aprobar el crédito o solicitar garantías adicionales.</p>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="highlight-box mt-4">
                                    <h5 class="mb-3" style="color: var(--purple-dark);"><i class="fas fa-info-circle me-2"></i>Notas Importantes</h5>
                                    <ul>
                                        <li>El umbral de decisión óptimo (16.67%) fue seleccionado para maximizar el F1-Score y balancear la precisión con la capacidad de detectar malos pagadores.</li>
                                        <li>Este modelo ha sido calibrado para proporcionar probabilidades confiables de impago.</li>
                                        <li>Las decisiones automatizadas deben ser complementadas con revisión humana en casos frontera.</li>
                                        <li>El modelo debe ser reevaluado y recalibrado cada 6 meses para mantener su efectividad.</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <footer class="mt-5">
        <div class="container">
            <div class="row">
                <div class="col-md-6 text-center text-md-start mb-3 mb-md-0">
                    <h5><i class="fas fa-project-diagram me-2"></i>Riesgo Crediticio ML</h5>
                    <p class="mb-0">Sistema de evaluación de riesgo crediticio basado en machine learning</p>
                </div>
                <div class="col-md-6 text-center text-md-end">
                    <p class="mb-0">© 2025 Todos los derechos reservados</p>
                    <p class="mb-0">Modelo actualizado: 13 de noviembre de 2025</p>
                </div>
            </div>
        </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script>
        // Simulación de la predicción (en un entorno real, esto se conectaría al modelo)
        function predictRisk() {
            // Simular una probabilidad de riesgo basada en inputs (en la realidad, esto vendría del modelo)
            const randomProbability = (Math.random() * 60 + 5).toFixed(2);
            document.getElementById('riskProbability').textContent = `${randomProbability}%`;
            
            // Determinar el nivel de riesgo
            let riskLevel, riskColor, recommendation;
            if (randomProbability < 16.67) {
                riskLevel = "BAJO RIESGO";
                riskColor = "success";
                recommendation = "APROBAR CRÉDITO";
            } else if (randomProbability < 40) {
                riskLevel = "RIESGO MODERADO";
                riskColor = "warning";
                recommendation = "REVISIÓN MANUAL";
            } else {
                riskLevel = "ALTO RIESGO";
                riskColor = "danger";
                recommendation = "NO APROBAR";
            }
            
            document.getElementById('riskLabel').textContent = riskLevel;
            document.getElementById('riskLabel').style.color = `var(--bs-${riskColor})`;
            document.getElementById('recommendation').textContent = recommendation;
            document.getElementById('recommendation').className = `badge bg-${riskColor} text-dark fs-5 p-2`;
            
            // Mostrar el resultado
            document.getElementById('predictionResult').classList.remove('d-none');
            
            // Actualizar el gráfico de gauge
            updateRiskGauge(parseFloat(randomProbability));
        }
        
        // Función para crear un gráfico de gauge con Chart.js
        function updateRiskGauge(probability) {
            const ctx = document.createElement('canvas');
            ctx.id = 'riskGaugeChart';
            document.getElementById('riskGauge').innerHTML = '';
            document.getElementById('riskGauge').appendChild(ctx);
            
            new Chart(ctx, {
                type: 'doughnut',
                data: {
                    datasets: [{
                        data: [probability, 100 - probability],
                        backgroundColor: [
                            probability < 16.67 ? '#4CAF50' : 
                            probability < 40 ? '#FFC107' : '#F44336',
                            '#e0e0e0'
                        ],
                        borderWidth: 0
                    }]
                },
                options: {
                    rotation: -90 * Math.PI / 180,
                    circumference: 180 * Math.PI / 180,
                    cutout: '70%',
                    plugins: {
                        tooltip: { enabled: false },
                        legend: { display: false }
                    },
                    responsive: true,
                    maintainAspectRatio: false
                }
            });
        }
        
        // Inicializar un gauge vacío
        updateRiskGauge(25);
    </script>
</body>
</html>